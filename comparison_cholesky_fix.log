======================================================================
ARUC vs DARUC COMPARISON
  Start:    2020-06-15 00:00:00
  Horizon:  12h
  Rho:      from NPZ (uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha95.npz)
  MIP gap:  0.0050 (0.50%)
  Wind Z:   FIXED (diagonal=1, no curtailment)
  Network:  copperplate
  Output:   comparison_outputs/m06d15_12h_rho_npz_copperplate
======================================================================

======================================================================
RUNNING DARUC (two-step: DAM → robust reliability)
======================================================================
======================================================================
STEP 1: DETERMINISTIC DAY-AHEAD UC
======================================================================
Building DAMData from RTS-GMLC...
  Using SPP ensemble mean for wind Pmax: uncertainty_sets_refactored/data/forecasts_filtered_rts4_constellation_v2.parquet
  Done. Data shapes:
    n_gens   = 154
    n_buses  = 73
    n_lines  = 120
    n_periods= 12

Building Gurobi DAM UC model...
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2739141
Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
  [DAM] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 16352 rows, 12948 columns and 45397 nonzeros (Min)
Model fingerprint: 0x3c5243e1
Model has 4404 linear objective coefficients
Variable types: 7404 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e-01, 8e+02]
  Objective range  [1e-03, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+03]
Found heuristic solution: objective 4.779087e+08
Presolve removed 9384 rows and 9286 columns
Presolve time: 0.14s
Presolved: 6968 rows, 3662 columns, 18240 nonzeros
Variable types: 3588 continuous, 74 integer (74 binary)

Root relaxation: objective 2.172789e+05, 3004 iterations, 0.11 seconds (0.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0    217278.85298 217278.853  0.00%     -    0s

Explored 1 nodes (3004 simplex iterations) in 0.33 seconds (0.17 work units)
Thread count was 4 (of 4 available processors)

Solution count 2: 217279 4.77909e+08 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.172788529768e+05, best bound 2.172788529768e+05, gap 0.0000%

=== DAM UC Summary ===
Objective value: 217,278.85
Number of generators: 154
Number of buses:      73
Number of lines:      120
Number of periods:    12
Total generation (MWh across horizon): 47,790.87
Total load (MWh across horizon):       47,790.87
Units committed at least once: 92

Extracting DAM commitments for DARUC input...
  Total DAM unit-hours: 1104
  Total DAM startups:   61

======================================================================
STEP 2: DARUC (ROBUST RELIABILITY COMMITMENT)
======================================================================

Loading time-varying uncertainty from uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha95.npz...
  Sigma shape: (12, 4, 4)
  rho range: [1.151, 32.618]

Building Gurobi DARUC model (with DAM commitment floor)...
  [ARUC] fix_wind_z=True: fixing Z[wind_k,t,k]=1 (diagonal), Z[wind_k,t,j!=k]=0 (off-diagonal)
  [ARUC] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Set parameter NumericFocus to value 1
Set parameter BarHomogeneous to value -1
Set parameter ScaleFlag to value 1
Set parameter MIPGap to value 0.005
Set parameter Heuristics to value 0.2
Set parameter MIPFocus to value 1
Warm start: set 5544 binary start values from DAM solution
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Non-default parameters:
MIPGap  0.005
ScaleFlag  1
Heuristics  0.2
MIPFocus  1
NumericFocus  1

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 25448 rows, 33876 columns and 75229 nonzeros (Min)
Model fingerprint: 0xdf1a8780
Model has 4404 linear objective coefficients
Model has 888 quadratic constraints
Variable types: 28332 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e-01, 8e+02]
  QMatrix range    [1e+00, 1e+00]
  Objective range  [1e-03, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+03]

User MIP start did not produce a new incumbent solution

Presolve removed 19048 rows and 25897 columns
Presolve time: 0.20s
Presolved: 6400 rows, 7979 columns, 22570 nonzeros
Presolved model has 888 quadratic constraint(s)
Variable types: 7917 continuous, 62 integer (62 binary)

Root relaxation: objective 2.172675e+05, 2487 iterations, 0.10 seconds (0.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
Another try with MIP start
     0     0 217270.454    0    1          - 217270.454      -     -    0s
     0     0 219641.798    0    2          - 219641.798      -     -    1s
     0     0 258632.884    0    4          - 258632.884      -     -    1s
     0     0 311826.770    0    4          - 311826.770      -     -    2s
     0     0 387192.642    0    6          - 387192.642      -     -    3s
     0     0 392351.217    0    6          - 392351.217      -     -    3s
     0     0 425669.477    0    9          - 425669.477      -     -    3s
     0     0 426034.232    0    8          - 426034.232      -     -    4s
     0     0 440048.944    0    6          - 440048.944      -     -    4s
     0     0 440315.252    0    7          - 440315.252      -     -    4s
     0     0 453555.887    0    9          - 453555.887      -     -    5s
H    0     0                    6.555322e+07 453555.887  99.3%     -    6s
H    0     0                    6.554573e+07 453555.887  99.3%     -    6s
H    0     0                    529850.92067 453555.887  14.4%     -   11s
     0     2 453555.887    0    9 529850.921 453555.887  14.4%     -   14s
     1     4 453909.074    1    9 529850.921 453556.633  14.4%   156   15s
    67    72 485959.207   32    1 529850.921 453936.811  14.3%   141   20s
   133   116 520976.390   15    2 529850.921 460289.275  13.1%   180   25s
H  143   112                    510577.27569 460289.275  9.85%   178   26s
   206   127 496040.761   25    1 510577.276 461486.601  9.61%   189   30s
H  214   123                    509128.31724 461486.601  9.36%   183   32s
   243   128     cutoff    6      509128.317 461486.601  9.36%   212   35s
H  305   182                    509128.31687 467998.573  8.08%   243   39s
   306   205 502846.474   29    2 509128.317 467998.573  8.08%   243   40s
   375   222     cutoff   20      509128.317 471685.349  7.35%   260   46s
H  395   230                    509128.31464 472249.193  7.24%   291   50s
H  401   141                    501001.99415 490136.419  2.17%   290   56s
H  405   131                    501001.99319 495428.369  1.11%   287   60s
*  418   131              18    498309.54505 495788.818  0.51%   278   64s
   419   125     cutoff   18      498309.545 495788.818  0.51%   278   65s
*  426   115              16    496476.58302 495802.327  0.14%   273   65s

Explored 428 nodes (155182 simplex iterations) in 65.87 seconds (57.28 work units)
Thread count was 4 (of 4 available processors)

Solution count 7: 496477 498310 501002 ... 6.55457e+07

Optimal solution found (tolerance 5.00e-03)
Best objective 4.964765830206e+05, best bound 4.962700728149e+05, gap 0.0416%

=== ARUC-LDR UC Summary ===
Objective value: 496,476.58
Number of generators: 154
Number of buses:      73
Number of lines:      120
Number of periods:    12
Total nominal generation (MWh): 47,790.87
Total load (MWh):               47,790.87
Units committed at least once: 95

======================================================================
Z COEFFICIENT ANALYSIS
======================================================================

Generators with non-zero Z coefficients: 19
Wind generators in problem: 4

Top 5 generators by total |Z|:
  317_WIND_1 (WIND): 12.00
  303_WIND_1 (WIND): 12.00
  122_WIND_1 (WIND): 12.00
  309_WIND_1 (WIND): 12.00
  123_STEAM_3 (THERMAL): 7.60

Example Z pattern for 101_STEAM_3:
  Shape: (12, 4) (time x K)
  First few rows:
k                           0         1         2         3
time                                                       
2020-06-15 00:00:00 -0.066797 -0.066797 -0.066797 -0.066797
2020-06-15 01:00:00 -0.034722 -0.034722 -0.034722 -0.034722
2020-06-15 02:00:00 -0.032859 -0.032859 -0.032859 -0.032859
2020-06-15 03:00:00 -0.032810 -0.032810 -0.032810 -0.032810
2020-06-15 04:00:00 -0.041249 -0.041249 -0.041249 -0.041249

======================================================================
DARUC DEVIATION ANALYSIS (DARUC vs DAM)
======================================================================

DAM objective:       217,278.85
DARUC objective:     496,476.58
Cost increase:       279,197.73  (+128.50%)

Generators with additional commitments: 3
Total extra unit-hours committed: 36

Details:
     gen_id gen_type  extra_committed_hours  dam_committed_hours  daruc_committed_hours                          periods_added
115_STEAM_3  THERMAL                     12                    0                     12 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
123_STEAM_3  THERMAL                     12                    0                     12 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
223_STEAM_3  THERMAL                     12                    0                     12 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]

Verified: u_DARUC >= u_DAM for all (i, t).

======================================================================
Z MATRIX ANALYSIS
======================================================================

  Period 2020-06-15 00:00:00:  rho=1.1507
    Column sums (all gens):  [ 4.76576492e-14 -2.61647357e-14 -1.60699921e-16 -2.00262714e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 01:00:00:  rho=4.4412
    Column sums (all gens):  [-8.31060518e-14 -1.67455513e-14 -1.13894391e-14  4.51443091e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 02:00:00:  rho=7.4231
    Column sums (all gens):  [-6.99232561e-14 -4.73432541e-14 -7.14793186e-15 -2.54193523e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 03:00:00:  rho=5.9112
    Column sums (all gens):  [4.78649804e-15 2.21069324e-14 4.13945710e-14 3.13824508e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 04:00:00:  rho=2.6366
    Column sums (all gens):  [8.03191937e-14 1.82438764e-13 1.61165190e-14 4.45862676e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 05:00:00:  rho=1.9519
    Column sums (all gens):  [ 3.95742005e-13 -2.81845556e-13  7.32369927e-14  8.16021580e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 06:00:00:  rho=32.6183
    Column sums (all gens):  [ 7.63753041e-12  8.08727956e-13 -3.75445526e-12  3.74107688e-12]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 07:00:00:  rho=15.9636
    Column sums (all gens):  [-2.04859622e-13  6.10702166e-14  1.21678641e-13  8.15093506e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 08:00:00:  rho=6.5097
    Column sums (all gens):  [ 2.76536490e-14  1.69450350e-14  1.33334016e-13 -1.36096768e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 09:00:00:  rho=1.2399
    Column sums (all gens):  [4.93142033e-14 9.14609310e-14 3.28632423e-14 5.17487632e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 10:00:00:  rho=1.2850
    Column sums (all gens):  [-3.61172083e-14  7.26904762e-14  1.01471196e-14  7.21725758e-14]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 11:00:00:  rho=2.2137
    Column sums (all gens):  [1.65514035e-13 1.45209258e-13 7.86507453e-13 2.27355080e-13]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Non-wind generators with non-zero Z (175 entries):
               Z_row_sum  Z_row_abs_sum
gen_id                                 
123_STEAM_3    -0.690744       0.690744
212_CSP_1      -0.620926       0.620926
223_STEAM_3    -0.563246       0.563246
223_STEAM_1    -0.361382       0.361382
223_STEAM_2    -0.361382       0.361382
216_STEAM_1    -0.267184       0.267184
115_STEAM_3    -0.233680       0.233680
123_STEAM_2    -0.199366       0.199366
101_STEAM_3    -0.164500       0.164500
101_STEAM_4    -0.164500       0.164500
102_STEAM_3    -0.151005       0.151005
102_STEAM_4    -0.151005       0.151005
202_STEAM_3    -0.110951       0.110951
202_STEAM_4    -0.110951       0.110951
121_NUCLEAR_1  -0.019105       0.019105
======================================================================

DARUC objective: 496,476.58
DAM objective:   217,278.85

======================================================================
RUNNING ARUC-LDR (one-shot robust)
======================================================================
Building DAMData from RTS-GMLC...
  Using SPP ensemble mean for wind Pmax: uncertainty_sets_refactored/data/forecasts_filtered_rts4_constellation_v2.parquet
  Done. Data shapes:
    n_gens   = 154
    n_buses  = 73
    n_lines  = 120
    n_periods= 12 (total_hours=12)

Loading time-varying uncertainty from uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha95.npz...
  Wind IDs from provider: ['122_WIND_1', '303_WIND_1', '309_WIND_1', '317_WIND_1']
  Sigma shape: (12, 4, 4)
  rho range: [1.151, 32.618]

Building Gurobi ARUC-LDR model...
  [ARUC] fix_wind_z=True: fixing Z[wind_k,t,k]=1 (diagonal), Z[wind_k,t,j!=k]=0 (off-diagonal)
  [ARUC] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Set parameter NumericFocus to value 1
Set parameter BarHomogeneous to value -1
Set parameter ScaleFlag to value 1
Set parameter MIPGap to value 0.005
Set parameter Heuristics to value 0.2
Set parameter MIPFocus to value 1
  Solving quick DAM for warm start...
  [DAM] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Warm start: set 5544 binary start values from DAM solution
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Non-default parameters:
MIPGap  0.005
ScaleFlag  1
Heuristics  0.2
MIPFocus  1
NumericFocus  1

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 19904 rows, 28332 columns and 64141 nonzeros (Min)
Model fingerprint: 0xfcaa66e5
Model has 4404 linear objective coefficients
Model has 888 quadratic constraints
Variable types: 22788 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e-01, 8e+02]
  QMatrix range    [1e+00, 1e+00]
  Objective range  [1e-03, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+03]

User MIP start did not produce a new incumbent solution

Presolve removed 12984 rows and 20314 columns
Presolve time: 0.20s
Presolved: 6920 rows, 8018 columns, 24180 nonzeros
Presolved model has 888 quadratic constraint(s)
Variable types: 7944 continuous, 74 integer (74 binary)

Root relaxation: objective 2.172675e+05, 3111 iterations, 0.09 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
     0     0 217267.459    0    -          - 217267.459      -     -    0s
Another try with MIP start
     0     0 217611.077    0    1          - 217611.077      -     -    1s
     0     0 224599.814    0    1          - 224599.814      -     -    1s
Another try with MIP start
     0     0 226518.025    0    1          - 226518.025      -     -    2s
     0     0 310503.459    0   12          - 310503.459      -     -    3s
     0     0 368030.670    0   10          - 368030.670      -     -    3s
     0     0 369694.839    0   10          - 369694.839      -     -    3s
     0     0 397286.483    0   12          - 397286.483      -     -    4s
H    0     0                    465791.99515 397286.483  14.7%     -    5s
     0     0 397286.483    0   12 465791.995 397286.483  14.7%     -   10s
     0     0 428662.079    0   15 465791.995 428662.079  7.97%     -   16s
     0     0 441463.279    0    9 465791.995 441463.279  5.22%     -   18s
     0     0 441575.600    0    8 465791.995 441575.600  5.20%     -   18s
     0     0 450405.212    0    8 465791.995 450405.212  3.30%     -   19s
     0     0 450405.212    0    8 465791.995 450405.212  3.30%     -   19s
H    0     0                    459224.29291 450405.212  1.92%     -   24s
     0     2 450405.212    0    8 459224.293 450405.212  1.92%     -   24s
     1     4 450581.893    1    9 459224.293 450407.766  1.92%   733   25s
H   46    27                    459224.29286 453131.212  1.33%   456   29s
    47    25     cutoff   10      459224.293 453131.212  1.33%   475   30s
    69    17 456857.401   14    4 459224.293 455299.123  0.85%   694   35s
H  115    15                    459224.28995 456278.602  0.64%   626   39s
   117    15 457247.338   10    4 459224.290 456527.281  0.59%   636   40s
H  140    20                    459224.28874 456528.316  0.59%   582   41s
*  140    20              23    459224.28874 456528.316  0.59%   582   41s

Cutting planes:
  Implied bound: 72
  MIR: 1
  Flow cover: 5
  Relax-and-lift: 11

Explored 157 nodes (141461 simplex iterations) in 43.29 seconds (35.57 work units)
Thread count was 4 (of 4 available processors)

Solution count 3: 459224 459224 465792 

Optimal solution found (tolerance 5.00e-03)
Best objective 4.592242887511e+05, best bound 4.579427263076e+05, gap 0.2791%

=== ARUC-LDR UC Summary ===
Objective value: 459,224.29
Number of generators: 154
Number of buses:      73
Number of lines:      120
Number of periods:    12
Total nominal generation (MWh): 47,790.87
Total load (MWh):               47,790.87
Units committed at least once: 94

======================================================================
Z COEFFICIENT ANALYSIS
======================================================================

Generators with non-zero Z coefficients: 18
Wind generators in problem: 4

Top 5 generators by total |Z|:
  317_WIND_1 (WIND): 12.00
  122_WIND_1 (WIND): 12.00
  309_WIND_1 (WIND): 12.00
  303_WIND_1 (WIND): 12.00
  123_STEAM_3 (THERMAL): 7.60

Example Z pattern for 101_STEAM_3:
  Shape: (12, 4) (time x K)
  First few rows:
k                           0         1         2         3
time                                                       
2020-06-15 00:00:00 -0.066792 -0.066794 -0.066794 -0.066809
2020-06-15 01:00:00 -0.034722 -0.034722 -0.034722 -0.034722
2020-06-15 02:00:00 -0.032859 -0.032858 -0.032859 -0.032860
2020-06-15 03:00:00 -0.032810 -0.032810 -0.032810 -0.032810
2020-06-15 04:00:00 -0.041234 -0.041234 -0.041273 -0.041255

======================================================================
Z MATRIX ANALYSIS
======================================================================

  Period 2020-06-15 00:00:00:  rho=1.1507
    Column sums (all gens):  [-8.65292504e-10 -8.65375327e-10 -8.65280514e-10 -8.67022676e-10]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 01:00:00:  rho=4.4412
    Column sums (all gens):  [-1.42757214e-09 -1.42773371e-09 -1.42759315e-09 -1.42639234e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 02:00:00:  rho=7.4231
    Column sums (all gens):  [-1.50456168e-09 -1.50459334e-09 -1.50446433e-09 -1.50432089e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 03:00:00:  rho=5.9112
    Column sums (all gens):  [3.58793648e-09 3.58789953e-09 3.58806473e-09 3.58812091e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 04:00:00:  rho=2.6366
    Column sums (all gens):  [8.30295527e-10 8.30279401e-10 8.32768077e-10 8.31628100e-10]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 05:00:00:  rho=1.9519
    Column sums (all gens):  [-9.25785615e-10 -9.28206623e-10 -9.33012778e-10 -9.32611766e-10]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 06:00:00:  rho=32.6183
    Column sums (all gens):  [-2.15266460e-09 -2.15312768e-09 -2.15527018e-09 -2.15242379e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 07:00:00:  rho=15.9636
    Column sums (all gens):  [-7.52130941e-10 -7.52228502e-10 -7.52720108e-10 -7.51839480e-10]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 08:00:00:  rho=6.5097
    Column sums (all gens):  [1.99352770e-09 1.99380246e-09 1.99060723e-09 1.99412176e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 09:00:00:  rho=1.2399
    Column sums (all gens):  [-1.13148596e-09 -1.13175602e-09 -1.13066445e-09 -1.13276122e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 10:00:00:  rho=1.2850
    Column sums (all gens):  [1.24297100e-09 1.24271493e-09 1.24208732e-09 1.24369381e-09]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Period 2020-06-15 11:00:00:  rho=2.2137
    Column sums (all gens):  [-4.26519681e-10 -4.26867430e-10 -4.29347446e-10 -4.25234514e-10]
    Column sums (wind only): [1. 1. 1. 1.]
    Column sums (non-wind):  [-1. -1. -1. -1.]
    122_WIND_1            Z=[+1.0000, +0.0000, +0.0000, +0.0000]  sum=+1.0000
    303_WIND_1            Z=[+0.0000, +1.0000, +0.0000, +0.0000]  sum=+1.0000
    309_WIND_1            Z=[+0.0000, +0.0000, +1.0000, +0.0000]  sum=+1.0000
    317_WIND_1            Z=[+0.0000, +0.0000, +0.0000, +1.0000]  sum=+1.0000

  Non-wind generators with non-zero Z (163 entries):
             Z_row_sum  Z_row_abs_sum
gen_id                               
123_STEAM_3  -0.690739       0.690739
212_CSP_1    -0.620903       0.620903
223_STEAM_3  -0.568492       0.568492
223_STEAM_1  -0.361396       0.361396
223_STEAM_2  -0.361396       0.361396
216_STEAM_1  -0.271300       0.271300
115_STEAM_3  -0.240031       0.240031
123_STEAM_2  -0.192067       0.192067
101_STEAM_4  -0.164492       0.164492
101_STEAM_3  -0.164492       0.164492
102_STEAM_3  -0.154901       0.154901
102_STEAM_4  -0.154901       0.154901
202_STEAM_4  -0.113018       0.113018
202_STEAM_3  -0.113018       0.113018
======================================================================

ARUC-LDR objective: 459,224.29

======================================================================
GENERATING COMPARISON
======================================================================
  Common time periods: 12

Generating figures...
  Saved fig_commitment_cost.pdf/.png
  Saved fig_z_comparison.pdf/.png
  Saved fig_wind_curtailment.pdf/.png

======================================================================
ARUC vs DARUC COMPARISON SUMMARY
======================================================================

--- Objective Values ---
  DAM (deterministic):      217,278.85
  DARUC (two-step):         496,476.58
  ARUC-LDR (one-shot):      459,224.29
  ARUC − DARUC:             -37,252.29  (-7.50%)
  DARUC − DAM:              279,197.73  (+128.50%)
  ARUC − DAM:               241,945.44  (+111.35%)

--- Cost Breakdown ---
                             No-Load       Startup      Shutdown        Energy         Slack         Total
  DAM                      67,580.28     10,000.00          0.00    139,698.57          0.00    217,278.85
  DARUC                    88,020.51     10,000.00          0.00    291,166.71          0.00    389,187.22
  ARUC-LDR                 49,512.67     10,000.00          0.00    291,701.96          0.00    351,214.63

--- Commitment Summary ---
  ARUC  total unit-hours: 1128
  DARUC total unit-hours: 1140
  DAM   total unit-hours: 1104
  Generators committed only in ARUC:  0
  Generators committed only in DARUC: 1
    121_NUCLEAR_1

--- Dispatch Totals (MWh over common horizon) ---
  ARUC  : HYDRO=6,709.6, SOLAR=9,372.2, THERMAL=16,307.3, WIND=15,401.8
  DARUC : HYDRO=5,386.1, SOLAR=7,786.0, THERMAL=21,059.3, WIND=13,559.5

--- Z Matrix Summary ---
  ARUC: 18 generators with active Z, mean wind ||Z||=1.0000
  DARUC: 19 generators with active Z, mean wind ||Z||=1.0000

--- DARUC Extra Commitments (beyond DAM) ---
  Generators with extra hours: 3
  Total extra unit-hours:      36
    115_STEAM_3 (THERMAL): +12h (DAM=0h)
    123_STEAM_3 (THERMAL): +12h (DAM=0h)
    223_STEAM_3 (THERMAL): +12h (DAM=0h)

--- Wind Curtailment ---
               Total (MWh)   % Available
  DAM                  0.0          0.0%
    122_WIND_1: 0.0 MW avg
    303_WIND_1: 0.0 MW avg
    309_WIND_1: 0.0 MW avg
    317_WIND_1: 0.0 MW avg
  ARUC             3,298.8         17.6%
    122_WIND_1: 76.9 MW avg
    303_WIND_1: 148.1 MW avg
    309_WIND_1: 46.6 MW avg
    317_WIND_1: 3.3 MW avg
  DARUC            5,141.0         27.5%
    122_WIND_1: 120.6 MW avg
    303_WIND_1: 226.4 MW avg
    309_WIND_1: 35.1 MW avg
    317_WIND_1: 46.4 MW avg

======================================================================

  Saved comparison_summary.txt

======================================================================
QUICK COMPARISON
======================================================================
  DAM objective:       217,278.85
  DARUC objective:     496,476.58  (+279,197.73 vs DAM)
  ARUC objective:      459,224.29  (+241,945.44 vs DAM)

  Commitment differences: 12 (gen,hour) entries differ

  All outputs: comparison_outputs/m06d15_12h_rho_npz_copperplate/
======================================================================
