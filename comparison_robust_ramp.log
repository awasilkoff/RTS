======================================================================
ARUC vs DARUC COMPARISON
  Start:    2020-05-15 00:00:00
  Horizon:  24h
  Rho:      from NPZ (uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha0.90.npz)
  MIP gap:  0.0100 (1.00%)
  DARUC obj: incremental (dispatch scale=0.1)
  Robust ramp: ON (SOC-based worst-case ramp constraints)
  Network:  copperplate
  Output:   comparison_outputs/m05d15_24h_robust_ramp
======================================================================

======================================================================
RUNNING DARUC (two-step: DAM â†’ robust reliability)
======================================================================
======================================================================
STEP 1: DETERMINISTIC DAY-AHEAD UC
======================================================================
Building DAMData from RTS-GMLC...
  Excluded 81 generators: {'RTPV': 31, 'PV': 25, 'HYDRO': 19, 'SYNC_COND': 3, 'NUCLEAR': 1, 'ROR': 1, 'STORAGE': 1}
  Using SPP ensemble mean for wind Pmax: uncertainty_sets_refactored/data/forecasts_filtered_rts4_constellation_v2.parquet
  Done. Data shapes:
    n_gens   = 77
    n_buses  = 73
    n_lines  = 120
    n_periods= 24

Building Gurobi DAM UC model...
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2739141
Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
  [DAM] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 16126 rows, 9264 columns and 52746 nonzeros (Min)
Model fingerprint: 0x8e75b735
Model has 5328 linear objective coefficients
Variable types: 3720 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+03]
  Objective range  [1e-03, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 6e+03]
Found heuristic solution: objective 1.081076e+09
Presolve removed 4363 rows and 2570 columns
Presolve time: 0.44s
Presolved: 11763 rows, 6694 columns, 44019 nonzeros
Variable types: 1800 continuous, 4894 integer (4894 binary)

Root relaxation: objective 1.781079e+06, 2920 iterations, 0.17 seconds (0.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1781078.70    0  119 1.0811e+09 1781078.70   100%     -    0s
H    0     0                    4620490.6696 1781078.70  61.5%     -    0s
H    0     0                    4055637.3318 1781078.70  56.1%     -    0s
H    0     0                    4054146.3363 1781078.70  56.1%     -    0s
H    0     0                    2801689.7268 1781078.70  36.4%     -    0s
H    0     0                    2801383.5328 1781078.70  36.4%     -    0s
H    0     0                    2800387.0766 1781078.70  36.4%     -    0s
     0     0 1788361.06    0   94 2800387.08 1788361.06  36.1%     -    1s
H    0     0                    2214539.0200 1788361.06  19.2%     -    1s
H    0     0                    2067735.0857 1788361.06  13.5%     -    1s
H    0     0                    1791705.0280 1788361.06  0.19%     -    1s
H    0     0                    1791479.2724 1788361.06  0.17%     -    1s
     0     0 1788910.76    0  122 1791479.27 1788910.76  0.14%     -    1s
     0     0 1788925.77    0  122 1791479.27 1788925.77  0.14%     -    1s
     0     0 1788925.79    0  127 1791479.27 1788925.79  0.14%     -    1s
     0     0 1789256.10    0  146 1791479.27 1789256.10  0.12%     -    1s
     0     0 1789256.10    0   72 1791479.27 1789256.10  0.12%     -    2s
H    0     0                    1791021.0141 1789256.10  0.10%     -    2s
     0     0 1789256.10    0  140 1791021.01 1789256.10  0.10%     -    2s
     0     0 1789256.10    0  108 1791021.01 1789256.10  0.10%     -    3s
     0     0 1789291.66    0  106 1791021.01 1789291.66  0.10%     -    3s
     0     0 1789291.68    0  135 1791021.01 1789291.68  0.10%     -    3s
     0     0 1789430.74    0  110 1791021.01 1789430.74  0.09%     -    3s
     0     0 1789440.46    0  116 1791021.01 1789440.46  0.09%     -    3s
     0     0 1789440.48    0  116 1791021.01 1789440.48  0.09%     -    3s
     0     0 1789547.64    0  197 1791021.01 1789547.64  0.08%     -    4s
H    0     0                    1790740.8837 1789548.58  0.07%     -    4s
     0     0 1789599.96    0  181 1790740.88 1789599.96  0.06%     -    4s
     0     0 1789600.52    0  169 1790740.88 1789600.52  0.06%     -    4s
     0     0 1789646.25    0  188 1790740.88 1789646.25  0.06%     -    4s
     0     0 1789646.25    0   62 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789646.25    0  134 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789646.25    0  123 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789646.25    0  104 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789646.25    0  112 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789646.25    0  122 1790740.88 1789646.25  0.06%     -    5s
     0     0 1789647.36    0  148 1790740.88 1789647.36  0.06%     -    6s
     0     0 1789648.34    0  146 1790740.88 1789648.34  0.06%     -    6s
     0     0 1789720.08    0  147 1790740.88 1789720.08  0.06%     -    6s
     0     0 1789741.73    0  141 1790740.88 1789741.73  0.06%     -    6s
     0     0 1789758.11    0  161 1790740.88 1789758.11  0.05%     -    6s
     0     0 1789760.39    0  153 1790740.88 1789760.39  0.05%     -    6s
     0     0 1789760.75    0  162 1790740.88 1789760.75  0.05%     -    6s
     0     0 1789820.74    0  196 1790740.88 1789820.74  0.05%     -    6s
     0     0 1789835.52    0  169 1790740.88 1789835.52  0.05%     -    6s
     0     0 1789855.68    0  168 1790740.88 1789855.68  0.05%     -    6s
     0     0 1789860.57    0  175 1790740.88 1789860.57  0.05%     -    6s
     0     0 1789867.60    0  171 1790740.88 1789867.60  0.05%     -    7s
     0     0 1789869.43    0  175 1790740.88 1789869.43  0.05%     -    7s
     0     0 1789869.59    0  173 1790740.88 1789869.59  0.05%     -    7s
     0     0 1789890.75    0  173 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0   61 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  125 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  127 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  140 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  139 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  141 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  177 1790740.88 1789890.75  0.05%     -    7s
     0     0 1789890.75    0  156 1790740.88 1789890.75  0.05%     -    8s
     0     0 1789898.75    0  155 1790740.88 1789898.75  0.05%     -    8s
     0     0 1789898.75    0  155 1790740.88 1789898.75  0.05%     -    8s
     0     0 1789924.52    0  164 1790740.88 1789924.52  0.05%     -    8s
     0     0 1789937.95    0  169 1790740.88 1789937.95  0.04%     -    8s
     0     0 1789938.49    0  178 1790740.88 1789938.49  0.04%     -    8s
     0     0 1789977.50    0  153 1790740.88 1789977.50  0.04%     -    8s
     0     0 1789987.02    0  162 1790740.88 1789987.02  0.04%     -    8s
     0     0 1789989.43    0  163 1790740.88 1789989.43  0.04%     -    8s
     0     0 1789989.54    0  165 1790740.88 1789989.54  0.04%     -    8s
     0     0 1789994.55    0  168 1790740.88 1789994.55  0.04%     -    8s
     0     0 1790002.29    0  163 1790740.88 1790002.29  0.04%     -    8s
     0     0 1790007.31    0  161 1790740.88 1790007.31  0.04%     -    8s
     0     0 1790007.41    0  163 1790740.88 1790007.41  0.04%     -    8s
     0     0 1790010.46    0  182 1790740.88 1790010.46  0.04%     -    8s
     0     0 1790010.84    0  182 1790740.88 1790010.84  0.04%     -    8s
     0     0 1790010.84    0  182 1790740.88 1790010.84  0.04%     -    8s
     0     0 1790010.84    0  177 1790740.88 1790010.84  0.04%     -    8s
H    0     0                    1790613.0925 1790010.84  0.03%     -    9s
H    0     0                    1790569.8667 1790010.84  0.03%     -    9s
     0     0 1790010.84    0   58 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  109 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  128 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  144 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  139 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  142 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  145 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790010.84    0  147 1790569.87 1790010.84  0.03%     -    9s
     0     0 1790012.06    0  157 1790569.87 1790012.06  0.03%     -    9s
     0     0 1790014.88    0  160 1790569.87 1790014.88  0.03%     -    9s
     0     0 1790014.88    0  181 1790569.87 1790014.88  0.03%     -    9s
     0     0 1790016.70    0  179 1790569.87 1790016.70  0.03%     -    9s
     0     0 1790017.25    0  178 1790569.87 1790017.25  0.03%     -    9s
     0     0 1790017.25    0  178 1790569.87 1790017.25  0.03%     -   10s
     0     0 1790017.25    0  178 1790569.87 1790017.25  0.03%     -   10s
     0     0 1790017.25    0  178 1790569.87 1790017.25  0.03%     -   10s
     0     2 1790017.35    0  178 1790569.87 1790017.35  0.03%     -   10s
*   25    14               8    1790568.2340 1790045.97  0.03%  32.7   10s
H   69    22                    1790521.0001 1790210.47  0.02%  20.2   10s
*  112    15               6    1790455.9410 1790283.49  0.01%  17.1   10s

Cutting planes:
  Learned: 2
  Gomory: 5
  Lift-and-project: 2
  Cover: 12
  Implied bound: 1
  Clique: 4
  MIR: 59
  StrongCG: 2
  Flow cover: 28
  Zero half: 2
  Relax-and-lift: 1

Explored 132 nodes (17222 simplex iterations) in 10.51 seconds (3.09 work units)
Thread count was 4 (of 4 available processors)

Solution count 10: 1.79046e+06 1.79052e+06 1.79057e+06 ... 2.06774e+06

Optimal solution found (tolerance 1.00e-04)
Best objective 1.790455940987e+06, best bound 1.790351029242e+06, gap 0.0059%

=== DAM UC Summary ===
Objective value: 1,790,455.94
Number of generators: 77
Number of buses:      73
Number of lines:      120
Number of periods:    24
Total generation (MWh across horizon): 108,107.63
Total load (MWh across horizon):       108,107.63
Units committed at least once: 28

Extracting DAM commitments for DARUC input...
  Total DAM unit-hours: 564
  Total DAM startups:   12

======================================================================
STEP 2: DARUC (ROBUST RELIABILITY COMMITMENT)
======================================================================

Loading time-varying uncertainty from uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha0.90.npz...
  Sigma shape: (24, 4, 4)
  rho range: [0.345, 26.515]

Building Gurobi DARUC model (with DAM commitment floor)...
  [ARUC] Incremental objective: commitment costs for additional units only, worst-case dispatch scaled by 0.1
  [ARUC] robust_ramp=True: using SOC-based ramp constraints for robust periods
  [ARUC] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Set parameter NumericFocus to value 1
Set parameter BarHomogeneous to value -1
Set parameter ScaleFlag to value 1
Set parameter MIPGap to value 0.01
Set parameter Heuristics to value 0.2
Set parameter MIPFocus to value 1
Warm start: set 5544 binary start values from DAM solution
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Non-default parameters:
MIPGap  0.01
ScaleFlag  1
Heuristics  0.2
MIPFocus  1
NumericFocus  1

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 29159 rows, 45961 columns and 129159 nonzeros (Min)
Model fingerprint: 0x89201517
Model has 2593 linear objective coefficients
Model has 1872 quadratic constraints
Variable types: 40417 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e-04, 3e+04]
  QMatrix range    [1e+00, 1e+00]
  Objective range  [1e-01, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-01, 6e+03]

User MIP start did not produce a new incumbent solution

Presolve removed 13709 rows and 26043 columns
Presolve time: 1.09s
Presolved: 15450 rows, 19918 columns, 84986 nonzeros
Presolved model has 1872 quadratic constraint(s)
Variable types: 16344 continuous, 3574 integer (3574 binary)

Root relaxation: objective 1.484361e+05, 5541 iterations, 0.16 seconds (0.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                    5.404657e+07 148436.132   100%     -    7s
*    0     0               0    5.404657e+07 148436.132   100%     -    7s
     0     0 148436.132    0    - 5.4047e+07 148436.132   100%     -    7s
     0     0 148436.132    0    - 5.4047e+07 148436.132   100%     -    7s
     0     0 148436.132    0    - 5.4047e+07 148436.132   100%     -    8s
     0     0 148436.132    0    - 5.4047e+07 148436.132   100%     -    8s
     0     0 148769.408    0    - 5.4047e+07 148769.408   100%     -    9s
     0     0 153905.508    0    5 5.4047e+07 153905.508   100%     -   11s
Another try with MIP start
     0     0 153905.508    0    5 5.4047e+07 153905.508   100%     -   15s
     0     0 153905.508    0    5 5.4047e+07 153905.508   100%     -   27s
     0     0 153905.508    0    5 5.4047e+07 153905.508   100%     -   36s
     0     0 170054.364    0   79 5.4047e+07 170054.364   100%     -   41s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   44s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   45s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   51s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   55s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   60s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   65s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   72s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   76s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   87s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   92s
     0     0 172368.839    0   34 5.4047e+07 172368.839   100%     -   99s
     0     0 181747.621    0   35 5.4047e+07 181747.621   100%     -  108s
     0     0 182524.083    0   39 5.4047e+07 182524.083   100%     -  109s
     0     0 182524.834    0   39 5.4047e+07 182524.834   100%     -  110s
     0     0 182801.511    0   33 5.4047e+07 182801.511   100%     -  113s
     0     0 182804.318    0   33 5.4047e+07 182804.318   100%     -  114s
     0     0 182940.015    0   41 5.4047e+07 182940.015   100%     -  117s
     0     0 182946.551    0   43 5.4047e+07 182946.551   100%     -  118s
     0     0 183044.940    0   14 5.4047e+07 183044.940   100%     -  119s
     0     0 183044.940    0   14 5.4047e+07 183044.940   100%     -  119s
     0     0 183044.940    0   14 5.4047e+07 183044.940   100%     -  120s
H    0     0                    399462.81633 183045.828  54.2%     -  147s
H    0     0                    200016.95095 183045.828  8.48%     -  149s
H    0     0                    186452.06937 183045.828  1.83%     -  151s
H    0     0                    186289.51430 183045.828  1.74%     -  152s
     0     2 183045.828    0   14 186289.514 183045.828  1.74%     -  157s
     5     5 183773.296    3   41 186289.514 183215.380  1.65%   790  162s
    10     9 184024.593    6   13 186289.514 183215.380  1.65%  1256  165s
    31    30 184110.355   18   22 186289.514 183215.380  1.65%   562  170s
    47    46 184528.884   25   16 186289.514 183215.380  1.65%   390  175s
    60    56 184996.086   31   19 186289.514 183215.380  1.65%   339  180s
H   65    61                    186103.89140 183215.380  1.55%   357  184s
H   66    61                    186103.88692 183215.380  1.55%   353  184s
    67    64 184861.527   33   11 186103.887 183215.380  1.55%   349  185s
    79    73 185783.545   36   34 186103.887 183215.380  1.55%   363  190s
    91    74 186036.369   33    - 186103.887 183215.380  1.55%   336  204s
    93    77 185504.484   40    1 186103.887 183215.380  1.55%   346  206s
    99    83 185579.194   43    2 186103.887 183394.360  1.46%   384  212s
   103    84 185997.673   45    - 186103.887 183394.360  1.46%   383  215s
   106    84 186035.138   46    - 186103.887 183553.684  1.37%   388  220s
H  112    89                    186103.88643 183553.684  1.37%   440  222s
   119    97 185226.103   10    7 186103.886 183553.684  1.37%   434  227s
   130   112 185284.323   14    7 186103.886 183553.684  1.37%   460  230s
   142   112 185786.164   18    3 186103.886 183553.684  1.37%   444  236s
   154   116 184331.538    5   45 186103.886 183553.684  1.37%   466  243s
   156   116 185182.293   19    - 186103.886 183828.609  1.22%   484  245s
   162   131 184911.953    8   22 186103.886 183852.152  1.21%   575  251s
   177   140 185159.410   19   12 186103.886 183852.152  1.21%   555  255s
   187   147 185950.456   22   12 186103.886 183852.152  1.21%   562  261s
   198   153 186016.302   26    1 186103.886 183852.152  1.21%   568  266s
H  204   134                    185611.37189 183852.152  0.95%   564  270s

Cutting planes:
  Gomory: 2
  Implied bound: 29
  MIR: 3
  Flow cover: 14
  Relax-and-lift: 2

Explored 215 nodes (226314 simplex iterations) in 270.41 seconds (121.75 work units)
Thread count was 4 (of 4 available processors)

Solution count 7: 185611 186104 186290 ... 5.40466e+07

Optimal solution found (tolerance 1.00e-02)
Best objective 1.856113718893e+05, best bound 1.838521524734e+05, gap 0.9478%

=== ARUC-LDR UC Summary ===
Objective value: 185,611.37
Number of generators: 77
Number of buses:      73
Number of lines:      120
Number of periods:    24
Total nominal generation (MWh): 108,107.63
Total load (MWh):               108,107.63
Units committed at least once: 31

======================================================================
Z COEFFICIENT ANALYSIS
======================================================================

Generators with non-zero Z coefficients: 31
Wind generators in problem: 4

Top 5 generators by total |Z|:
  317_WIND_1 (WIND): 31.72
  303_WIND_1 (WIND): 31.67
  122_WIND_1 (WIND): 30.71
  309_WIND_1 (WIND): 26.62
  223_STEAM_3 (THERMAL): 5.75

Example Z pattern for 101_CT_1:
  Shape: (24, 4) (time x K)
  First few rows:
k                      0    1    2    3
time                                   
2020-05-15 00:00:00  0.0  0.0  0.0  0.0
2020-05-15 01:00:00  0.0  0.0  0.0  0.0
2020-05-15 02:00:00  0.0  0.0  0.0  0.0
2020-05-15 03:00:00  0.0  0.0  0.0  0.0
2020-05-15 04:00:00  0.0  0.0  0.0  0.0

======================================================================
DARUC DEVIATION ANALYSIS (DARUC vs DAM)
======================================================================

DAM objective:     1,790,455.94
DARUC objective:     185,611.37
Cost increase:    -1,604,844.57  (-89.63%)

Generators with additional commitments: 8
Total extra unit-hours committed: 33

Details:
     gen_id gen_type  extra_committed_hours  dam_committed_hours  daruc_committed_hours                                                              periods_added
   101_CT_1  THERMAL                      2                    0                      2                                                                    [8, 14]
   101_CT_2  THERMAL                      1                    0                      1                                                                       [14]
115_STEAM_3  THERMAL                      1                   23                     24                                                                       [23]
   118_CC_1  THERMAL                      1                    9                     10                                                                       [20]
123_STEAM_2  THERMAL                      1                   22                     23                                                                       [22]
   315_CT_6  THERMAL                      1                    2                      3                                                                       [15]
   323_CC_1  THERMAL                      5                    8                     13                                                       [17, 18, 19, 20, 21]
   323_CC_2  THERMAL                     21                    0                     21 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

Verified: u_DARUC >= u_DAM for all (i, t).

======================================================================
Z MATRIX ANALYSIS
======================================================================

  Period 2020-05-15 00:00:00:  rho=0.3605
    Column sums (all gens):  [ 1.69975145e-13 -5.58442181e-14  4.68070027e-13 -7.89993071e-15]
    Column sums (wind only): [0.29054839 0.29054722 0.29054631 0.29055243]
    Column sums (non-wind):  [-0.29054839 -0.29054722 -0.29054631 -0.29055243]
    122_WIND_1            Z=[+0.8129, -0.1871, -0.1871, -0.1871]  sum=+0.2516
    303_WIND_1            Z=[-0.1903, +0.8097, -0.1903, -0.1903]  sum=+0.2388
    309_WIND_1            Z=[-0.1422, -0.1422, +0.8578, -0.1422]  sum=+0.4312
    317_WIND_1            Z=[-0.1898, -0.1898, -0.1898, +0.8102]  sum=+0.2406

  Period 2020-05-15 01:00:00:  rho=2.9575
    Column sums (all gens):  [-1.56763491e-13 -5.06233944e-12  2.22533103e-12 -3.99983865e-13]
    Column sums (wind only): [0.13986136 0.13982782 0.1398059  0.13994923]
    Column sums (non-wind):  [-0.13986136 -0.13982782 -0.1398059  -0.13994923]
    122_WIND_1            Z=[+0.7752, -0.2248, -0.2248, -0.2247]  sum=+0.1009
    303_WIND_1            Z=[-0.2736, +0.7264, -0.2736, -0.2736]  sum=-0.0944
    309_WIND_1            Z=[-0.0990, -0.0990, +0.9010, -0.0990]  sum=+0.6042
    317_WIND_1            Z=[-0.2628, -0.2628, -0.2628, +0.7372]  sum=-0.0513

  Period 2020-05-15 02:00:00:  rho=5.3319
    Column sums (all gens):  [-1.35969014e-12 -2.17248441e-12  5.69544412e-14  2.13008430e-13]
    Column sums (wind only): [0.12023079 0.12022598 0.12022591 0.12024212]
    Column sums (non-wind):  [-0.12023079 -0.12022598 -0.12022591 -0.12024212]
    122_WIND_1            Z=[+0.7857, -0.2143, -0.2143, -0.2143]  sum=+0.1428
    303_WIND_1            Z=[-0.3077, +0.6923, -0.3077, -0.3077]  sum=-0.2308
    309_WIND_1            Z=[-0.0756, -0.0756, +0.9244, -0.0756]  sum=+0.6978
    317_WIND_1            Z=[-0.2822, -0.2822, -0.2822, +0.7178]  sum=-0.1288

  Period 2020-05-15 03:00:00:  rho=4.4729
    Column sums (all gens):  [-1.01696429e-13 -4.46309656e-14 -3.77475828e-15  7.89507348e-14]
    Column sums (wind only): [0.11290034 0.11289917 0.11291164 0.1129105 ]
    Column sums (non-wind):  [-0.11290034 -0.11289917 -0.11291164 -0.1129105 ]
    122_WIND_1            Z=[+0.7946, -0.2054, -0.2054, -0.2054]  sum=+0.1786
    303_WIND_1            Z=[-0.3260, +0.6740, -0.3260, -0.3260]  sum=-0.3042
    309_WIND_1            Z=[-0.0653, -0.0653, +0.9347, -0.0653]  sum=+0.7388
    317_WIND_1            Z=[-0.2904, -0.2904, -0.2904, +0.7096]  sum=-0.1615

  Period 2020-05-15 04:00:00:  rho=1.9117
    Column sums (all gens):  [-9.52571355e-14 -1.56985536e-13 -1.61870517e-13  5.94177485e-14]
    Column sums (wind only): [0.12345838 0.12345923 0.12352185 0.1234916 ]
    Column sums (non-wind):  [-0.12345838 -0.12345923 -0.12352185 -0.1234916 ]
    122_WIND_1            Z=[+0.7883, -0.2117, -0.2116, -0.2116]  sum=+0.1534
    303_WIND_1            Z=[-0.3111, +0.6889, -0.3111, -0.3111]  sum=-0.2445
    309_WIND_1            Z=[-0.0710, -0.0710, +0.9290, -0.0710]  sum=+0.7160
    317_WIND_1            Z=[-0.2828, -0.2828, -0.2827, +0.7172]  sum=-0.1310

  Period 2020-05-15 05:00:00:  rho=1.1930
    Column sums (all gens):  [ 2.50022225e-13 -2.11053397e-13 -4.30100400e-13  1.80286341e-13]
    Column sums (wind only): [0.20885941 0.20886147 0.20886258 0.20886999]
    Column sums (non-wind):  [-0.20885941 -0.20886147 -0.20886258 -0.20886999]
    122_WIND_1            Z=[+0.7924, -0.2076, -0.2076, -0.2076]  sum=+0.1697
    303_WIND_1            Z=[-0.2549, +0.7451, -0.2549, -0.2549]  sum=-0.0197
    309_WIND_1            Z=[-0.0847, -0.0847, +0.9153, -0.0847]  sum=+0.6613
    317_WIND_1            Z=[-0.2440, -0.2440, -0.2440, +0.7560]  sum=+0.0241

  Period 2020-05-15 06:00:00:  rho=26.5150
    Column sums (all gens):  [-1.13486998e-12 -6.05626660e-14 -7.83706433e-13 -3.47152862e-14]
    Column sums (wind only): [0.25155518 0.25155815 0.25155016 0.25155613]
    Column sums (non-wind):  [-0.25155518 -0.25155815 -0.25155016 -0.25155613]
    122_WIND_1            Z=[+0.7765, -0.2235, -0.2235, -0.2235]  sum=+0.1061
    303_WIND_1            Z=[-0.2019, +0.7981, -0.2019, -0.2019]  sum=+0.1924
    309_WIND_1            Z=[-0.0482, -0.0482, +0.9518, -0.0482]  sum=+0.8074
    317_WIND_1            Z=[-0.2749, -0.2749, -0.2749, +0.7251]  sum=-0.0996

  Period 2020-05-15 07:00:00:  rho=11.6607
    Column sums (all gens):  [-1.17683641e-14  7.82707232e-15 -6.70574707e-14  8.44463388e-15]
    Column sums (wind only): [0.37730046 0.37730233 0.37729146 0.37730033]
    Column sums (non-wind):  [-0.37730046 -0.37730233 -0.37729146 -0.37730033]
    122_WIND_1            Z=[+0.8228, -0.1772, -0.1772, -0.1772]  sum=+0.2913
    303_WIND_1            Z=[-0.1848, +0.8152, -0.1848, -0.1848]  sum=+0.2607
    309_WIND_1            Z=[-0.0676, -0.0676, +0.9324, -0.0676]  sum=+0.7295
    317_WIND_1            Z=[-0.1931, -0.1931, -0.1931, +0.8069]  sum=+0.2277

  Period 2020-05-15 08:00:00:  rho=4.6917
    Column sums (all gens):  [-1.97730721e-13 -6.40598685e-14 -1.91158200e-12  4.53248550e-14]
    Column sums (wind only): [0.61874794 0.61874885 0.61876796 0.61874894]
    Column sums (non-wind):  [-0.61874794 -0.61874885 -0.61876796 -0.61874894]
    122_WIND_1            Z=[+0.8880, -0.1120, -0.1119, -0.1120]  sum=+0.5522
    303_WIND_1            Z=[-0.0995, +0.9005, -0.0995, -0.0995]  sum=+0.6021
    309_WIND_1            Z=[-0.0517, -0.0517, +0.9483, -0.0517]  sum=+0.7933
    317_WIND_1            Z=[-0.1181, -0.1181, -0.1181, +0.8819]  sum=+0.5275

  Period 2020-05-15 09:00:00:  rho=0.8425
    Column sums (all gens):  [-8.51541060e-14 -8.77076189e-15 -5.76649839e-13  2.38351006e-14]
    Column sums (wind only): [0.55859184 0.55859063 0.55859343 0.55859526]
    Column sums (non-wind):  [-0.55859184 -0.55859063 -0.55859343 -0.55859526]
    122_WIND_1            Z=[+0.8825, -0.1175, -0.1175, -0.1175]  sum=+0.5301
    303_WIND_1            Z=[-0.1588, +0.8412, -0.1588, -0.1588]  sum=+0.3650
    309_WIND_1            Z=[-0.0251, -0.0251, +0.9749, -0.0251]  sum=+0.8998
    317_WIND_1            Z=[-0.1401, -0.1401, -0.1401, +0.8599]  sum=+0.4395

  Period 2020-05-15 10:00:00:  rho=0.8720
    Column sums (all gens):  [-3.48610030e-14 -2.13162821e-14 -2.58459920e-13 -6.90818930e-14]
    Column sums (wind only): [0.63913504 0.63913477 0.63913515 0.63913663]
    Column sums (non-wind):  [-0.63913504 -0.63913477 -0.63913515 -0.63913663]
    122_WIND_1            Z=[+0.9000, -0.1000, -0.1000, -0.1000]  sum=+0.5999
    303_WIND_1            Z=[-0.1225, +0.8775, -0.1225, -0.1225]  sum=+0.5099
    309_WIND_1            Z=[-0.0229, -0.0229, +0.9771, -0.0229]  sum=+0.9084
    317_WIND_1            Z=[-0.1154, -0.1154, -0.1154, +0.8846]  sum=+0.5384

  Period 2020-05-15 11:00:00:  rho=1.5330
    Column sums (all gens):  [ 1.83186799e-14 -4.27435864e-14 -3.29736238e-14 -5.23643628e-14]
    Column sums (wind only): [0.7022476  0.70224728 0.70224679 0.70225011]
    Column sums (non-wind):  [-0.7022476  -0.70224728 -0.70224679 -0.70225011]
    122_WIND_1            Z=[+0.9139, -0.0861, -0.0861, -0.0861]  sum=+0.6558
    303_WIND_1            Z=[-0.0954, +0.9046, -0.0954, -0.0954]  sum=+0.6183
    309_WIND_1            Z=[-0.0234, -0.0234, +0.9766, -0.0234]  sum=+0.9064
    317_WIND_1            Z=[-0.0929, -0.0929, -0.0929, +0.9071]  sum=+0.6285

  Period 2020-05-15 12:00:00:  rho=2.5266
    Column sums (all gens):  [ 6.88338275e-15 -7.32747196e-15 -2.58904009e-13 -6.55170362e-14]
    Column sums (wind only): [0.77677197 0.77677209 0.77677189 0.77677313]
    Column sums (non-wind):  [-0.77677197 -0.77677209 -0.77677189 -0.77677313]
    122_WIND_1            Z=[+0.9365, -0.0635, -0.0635, -0.0635]  sum=+0.7462
    303_WIND_1            Z=[-0.0676, +0.9324, -0.0676, -0.0676]  sum=+0.7295
    309_WIND_1            Z=[-0.0254, -0.0254, +0.9746, -0.0254]  sum=+0.8983
    317_WIND_1            Z=[-0.0667, -0.0667, -0.0667, +0.9333]  sum=+0.7331

  Period 2020-05-15 13:00:00:  rho=1.7477
    Column sums (all gens):  [-5.93969318e-15 -4.48530102e-14 -7.43849426e-15 -1.61301094e-14]
    Column sums (wind only): [0.78415329 0.78415386 0.78415041 0.78415426]
    Column sums (non-wind):  [-0.78415329 -0.78415386 -0.78415041 -0.78415426]
    122_WIND_1            Z=[+0.9396, -0.0604, -0.0604, -0.0604]  sum=+0.7584
    303_WIND_1            Z=[-0.0615, +0.9385, -0.0615, -0.0615]  sum=+0.7542
    309_WIND_1            Z=[-0.0325, -0.0325, +0.9675, -0.0325]  sum=+0.8700
    317_WIND_1            Z=[-0.0615, -0.0615, -0.0615, +0.9385]  sum=+0.7540

  Period 2020-05-15 14:00:00:  rho=1.9406
    Column sums (all gens):  [3.81417120e-13 7.85482790e-13 2.64455124e-13 4.46379045e-14]
    Column sums (wind only): [0.78548508 0.78548562 0.78548435 0.78548551]
    Column sums (non-wind):  [-0.78548508 -0.78548562 -0.78548435 -0.78548551]
    122_WIND_1            Z=[+0.9395, -0.0605, -0.0605, -0.0605]  sum=+0.7581
    303_WIND_1            Z=[-0.0618, +0.9382, -0.0618, -0.0618]  sum=+0.7528
    309_WIND_1            Z=[-0.0300, -0.0300, +0.9700, -0.0300]  sum=+0.8798
    317_WIND_1            Z=[-0.0622, -0.0622, -0.0622, +0.9378]  sum=+0.7513

  Period 2020-05-15 15:00:00:  rho=2.2851
    Column sums (all gens):  [ 1.98174810e-14 -1.06692433e-13  4.18554080e-13  4.82183737e-14]
    Column sums (wind only): [0.77083596 0.77083635 0.77083533 0.77083658]
    Column sums (non-wind):  [-0.77083596 -0.77083635 -0.77083533 -0.77083658]
    122_WIND_1            Z=[+0.9347, -0.0653, -0.0653, -0.0653]  sum=+0.7387
    303_WIND_1            Z=[-0.0663, +0.9337, -0.0663, -0.0663]  sum=+0.7350
    309_WIND_1            Z=[-0.0308, -0.0308, +0.9692, -0.0308]  sum=+0.8768
    317_WIND_1            Z=[-0.0668, -0.0668, -0.0668, +0.9332]  sum=+0.7329

  Period 2020-05-15 16:00:00:  rho=2.0676
    Column sums (all gens):  [-1.96509475e-14  5.37347944e-14 -6.10622664e-14  5.33947886e-14]
    Column sums (wind only): [0.70225095 0.70225109 0.70224948 0.70225211]
    Column sums (non-wind):  [-0.70225095 -0.70225109 -0.70224948 -0.70225211]
    122_WIND_1            Z=[+0.9135, -0.0865, -0.0865, -0.0865]  sum=+0.6541
    303_WIND_1            Z=[-0.0868, +0.9132, -0.0868, -0.0868]  sum=+0.6526
    309_WIND_1            Z=[-0.0375, -0.0375, +0.9625, -0.0375]  sum=+0.8501
    317_WIND_1            Z=[-0.0870, -0.0870, -0.0870, +0.9130]  sum=+0.6521

  Period 2020-05-15 17:00:00:  rho=2.8194
    Column sums (all gens):  [ 7.20534743e-14  3.75255382e-14 -3.46389584e-14  6.10178574e-13]
    Column sums (wind only): [0.44553542 0.44553507 0.4455344  0.44553648]
    Column sums (non-wind):  [-0.44553542 -0.44553507 -0.4455344  -0.44553648]
    122_WIND_1            Z=[+0.8368, -0.1632, -0.1632, -0.1632]  sum=+0.3472
    303_WIND_1            Z=[-0.1695, +0.8305, -0.1695, -0.1695]  sum=+0.3219
    309_WIND_1            Z=[-0.0311, -0.0311, +0.9689, -0.0311]  sum=+0.8755
    317_WIND_1            Z=[-0.1906, -0.1906, -0.1906, +0.8094]  sum=+0.2377

  Period 2020-05-15 18:00:00:  rho=7.1594
    Column sums (all gens):  [-7.77156117e-16 -1.11022302e-15 -3.55271368e-15 -7.43987337e-13]
    Column sums (wind only): [0.3283599  0.32835985 0.32835912 0.32836074]
    Column sums (non-wind):  [-0.3283599  -0.32835985 -0.32835912 -0.32836074]
    122_WIND_1            Z=[+0.8160, -0.1840, -0.1840, -0.1840]  sum=+0.2640
    303_WIND_1            Z=[-0.2160, +0.7840, -0.2161, -0.2160]  sum=+0.1358
    309_WIND_1            Z=[-0.0276, -0.0276, +0.9724, -0.0276]  sum=+0.8895
    317_WIND_1            Z=[-0.2440, -0.2440, -0.2440, +0.7560]  sum=+0.0241

  Period 2020-05-15 19:00:00:  rho=16.4602
    Column sums (all gens):  [-1.67643677e-14  2.27595720e-14 -5.21804822e-14  2.10994416e-13]
    Column sums (wind only): [0.4529666  0.45296823 0.45296771 0.45296524]
    Column sums (non-wind):  [-0.4529666  -0.45296823 -0.45296771 -0.45296524]
    122_WIND_1            Z=[+0.8503, -0.1497, -0.1497, -0.1497]  sum=+0.4012
    303_WIND_1            Z=[-0.1803, +0.8197, -0.1803, -0.1803]  sum=+0.2789
    309_WIND_1            Z=[-0.0275, -0.0275, +0.9725, -0.0275]  sum=+0.8901
    317_WIND_1            Z=[-0.1896, -0.1896, -0.1896, +0.8104]  sum=+0.2417

  Period 2020-05-15 20:00:00:  rho=2.6743
    Column sums (all gens):  [-1.38500322e-13 -4.66626737e-13 -4.45199433e-13 -5.87307980e-14]
    Column sums (wind only): [0.37089371 0.37089404 0.37090056 0.37089649]
    Column sums (non-wind):  [-0.37089371 -0.37089404 -0.37090056 -0.37089649]
    122_WIND_1            Z=[+0.8264, -0.1736, -0.1736, -0.1736]  sum=+0.3058
    303_WIND_1            Z=[-0.1993, +0.8007, -0.1993, -0.1993]  sum=+0.2027
    309_WIND_1            Z=[-0.0522, -0.0522, +0.9478, -0.0522]  sum=+0.7910
    317_WIND_1            Z=[-0.2040, -0.2040, -0.2040, +0.7960]  sum=+0.1841

  Period 2020-05-15 21:00:00:  rho=0.3452
    Column sums (all gens):  [ 2.61084487e-11  4.38382664e-12 -1.97704075e-11  4.41313652e-15]
    Column sums (wind only): [0.80447954 0.80448073 0.80448049 0.80448291]
    Column sums (non-wind):  [-0.80447954 -0.80448073 -0.80448049 -0.80448291]
    122_WIND_1            Z=[+0.9560, -0.0440, -0.0440, -0.0440]  sum=+0.8238
    303_WIND_1            Z=[-0.0440, +0.9560, -0.0440, -0.0440]  sum=+0.8238
    309_WIND_1            Z=[-0.0634, -0.0634, +0.9366, -0.0634]  sum=+0.7465
    317_WIND_1            Z=[-0.0440, -0.0440, -0.0440, +0.9560]  sum=+0.8238

  Period 2020-05-15 22:00:00:  rho=1.0550
    Column sums (all gens):  [ 1.11022302e-16  7.50510765e-14 -7.67685915e-12 -1.69463664e-14]
    Column sums (wind only): [0.6752629  0.67525536 0.67528191 0.67526026]
    Column sums (non-wind):  [-0.6752629  -0.67525536 -0.67528191 -0.67526026]
    122_WIND_1            Z=[+0.8825, -0.1175, -0.1175, -0.1175]  sum=+0.5300
    303_WIND_1            Z=[-0.0651, +0.9349, -0.0651, -0.0651]  sum=+0.7395
    309_WIND_1            Z=[-0.0771, -0.0771, +0.9229, -0.0771]  sum=+0.6918
    317_WIND_1            Z=[-0.0651, -0.0651, -0.0651, +0.9349]  sum=+0.7397

  Period 2020-05-15 23:00:00:  rho=2.2555
    Column sums (all gens):  [1.64313008e-14 3.99680289e-14 6.43929354e-14 1.09636970e-14]
    Column sums (wind only): [0.59777927 0.59777928 0.59778455 0.5977797 ]
    Column sums (non-wind):  [-0.59777927 -0.59777928 -0.59778455 -0.5977797 ]
    122_WIND_1            Z=[+0.8778, -0.1222, -0.1222, -0.1222]  sum=+0.5110
    303_WIND_1            Z=[-0.0911, +0.9089, -0.0911, -0.0911]  sum=+0.6357
    309_WIND_1            Z=[-0.0978, -0.0978, +0.9022, -0.0978]  sum=+0.6088
    317_WIND_1            Z=[-0.0911, -0.0911, -0.0911, +0.9089]  sum=+0.6356

  Non-wind generators with non-zero Z (501 entries):
             Z_row_sum  Z_row_abs_sum
gen_id                               
223_STEAM_3  -0.202627       0.239605
107_CC_1     -0.128480       0.234762
212_CSP_1    -0.233600       0.233600
123_STEAM_3  -0.149599       0.214785
221_CC_1     -0.158598       0.185286
313_CC_1     -0.181796       0.181796
321_CC_1     -0.150009       0.180627
118_CC_1     -0.142587       0.164944
323_CC_1      0.055930       0.158998
223_STEAM_1  -0.149770       0.157572
223_STEAM_2  -0.149744       0.157547
216_STEAM_1  -0.111420       0.135059
115_STEAM_3  -0.066945       0.121443
116_STEAM_1  -0.057996       0.118285
316_STEAM_1  -0.060772       0.117273
101_STEAM_3  -0.117100       0.117100
101_STEAM_4  -0.117075       0.117075
323_CC_2      0.029789       0.115949
123_STEAM_2  -0.057887       0.113798
202_STEAM_4  -0.015480       0.073892
======================================================================

DARUC objective: 185,611.37
DAM objective:   1,790,455.94

======================================================================
RUNNING ARUC-LDR (one-shot robust)
======================================================================
Building DAMData from RTS-GMLC...
  Excluded 81 generators: {'RTPV': 31, 'PV': 25, 'HYDRO': 19, 'SYNC_COND': 3, 'NUCLEAR': 1, 'ROR': 1, 'STORAGE': 1}
  Using SPP ensemble mean for wind Pmax: uncertainty_sets_refactored/data/forecasts_filtered_rts4_constellation_v2.parquet
  Done. Data shapes:
    n_gens   = 77
    n_buses  = 73
    n_lines  = 120
    n_periods= 24 (total_hours=24)

Loading time-varying uncertainty from uncertainty_sets_refactored/data/uncertainty_sets_rts4_v2_16d/sigma_rho_alpha0.90.npz...
  Wind IDs from provider: ['122_WIND_1', '303_WIND_1', '309_WIND_1', '317_WIND_1']
  Sigma shape: (24, 4, 4)
  rho range: [0.345, 26.515]

Building Gurobi ARUC-LDR model...
  [ARUC] robust_ramp=True: using SOC-based ramp constraints for robust periods
  [ARUC] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Set parameter NumericFocus to value 1
Set parameter BarHomogeneous to value -1
Set parameter ScaleFlag to value 1
Set parameter MIPGap to value 0.01
Set parameter Heuristics to value 0.2
Set parameter MIPFocus to value 1
  Solving quick DAM for warm start...
  [DAM] Line flow constraints DISABLED (copper-plate mode)
Set parameter OutputFlag to value 1
Warm start: set 5544 binary start values from DAM solution
  Model built. Starting optimization...
Gurobi Optimizer version 13.0.0 build v13.0.0rc1 (mac64[x86] - Darwin 21.6.0 21H1320)

CPU model: Intel(R) Core(TM) i5-6267U CPU @ 2.90GHz
Thread count: 2 physical cores, 4 logical processors, using up to 4 threads

Non-default parameters:
MIPGap  0.01
ScaleFlag  1
Heuristics  0.2
MIPFocus  1
NumericFocus  1

Academic license 2739141 - for non-commercial use only - registered to wa___@bu.edu
Optimize a model with 23615 rows, 40417 columns and 118071 nonzeros (Min)
Model fingerprint: 0x665ef050
Model has 3505 linear objective coefficients
Model has 1872 quadratic constraints
Variable types: 34873 continuous, 5544 integer (5544 binary)
Coefficient statistics:
  Matrix range     [1e-04, 3e+04]
  QMatrix range    [1e+00, 1e+00]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-01, 6e+03]

User MIP start did not produce a new incumbent solution
Processed MIP start in 1.55 seconds (0.16 work units)

Presolve removed 6447 rows and 19176 columns (presolve time = 5s)...
Presolve removed 6447 rows and 19176 columns
Presolve time: 9.41s
Presolved: 17168 rows, 21241 columns, 94650 nonzeros
Presolved model has 1872 quadratic constraint(s)
Variable types: 16345 continuous, 4896 integer (4896 binary)

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   2.140638e+05   0.000000e+00     12s
    7926    1.7803840e+06   0.000000e+00   0.000000e+00     15s

Root relaxation: objective 1.780384e+06, 7926 iterations, 2.84 seconds (0.16 work units)
Another try with MIP start

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                    1.192633e+07 1780383.98  85.1%     -  111s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     -  178s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     -  354s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     -  510s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     -  640s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     -  807s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     - 1125s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     - 1285s
     0     0 1780383.98    0  122 1.1926e+07 1780383.98  85.1%     - 1549s
H    0     0                    1.169831e+07 1780383.98  84.8%     - 1579s
     0     0 1780383.98    0  122 1.1698e+07 1780383.98  84.8%     - 1796s
